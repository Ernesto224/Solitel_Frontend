<div class="flex flex-col mb-0 pb-0">


  <!-- Contenedor con scroll horizontal y vertical si es necesario -->
  <div class="overflow-x-auto overflow-y-auto max-h-screen">


    <!--Filtro de -->
    <div class="filter-container">
      <h2>Filtro de solicitudes telefónicas</h2>

      <div class="filter-form">
        <!-- Filtrar por carácter - ocupa toda la fila -->
        <div class="form-group filter-full-width">
          <label for="filtro-caracter">Filtrar por carácter:</label>
          <input type="text" id="filtro-caracter" class="w-full p-2 border rounded" placeholder="Ingrese carácter"
            [(ngModel)]="filtroCaracter">
        </div>

        <!-- Estado -->
        <div class="form-group">
          <label for="estado">Estado:</label>
          <div class="badge-container">
            <select [(ngModel)]="estadoTemporal"> <!-- Cambiado a estadoTemporal -->
              <option value="" disabled>Solicitud Proveedor</option>
              <option *ngFor="let estado of cantidadPorEstadoProveedor" [value]="estado.nombre">
                {{ estado.nombre }} ({{ estado.cantidad }})
              </option>

              <option value="" disabled>Solicitud Análisis</option>
              <option *ngFor="let estado of cantidadPorEstadoAnalisis" [value]="estado.nombre">
                {{ estado.nombre }} ({{ estado.cantidad }})
              </option>
            </select>
          </div>
        </div>


        <!-- Número único -->
        <div class="form-group">
          <label for="numero-unico">Número único:</label>
          <input type="text" id="numero-unico" class="w-full p-2 border rounded" placeholder="Número único"
            [(ngModel)]="numeroUnicoFiltro">
        </div>

        <!-- Fecha inicio -->
        <div class="form-group">
          <label for="fecha-inicio">Fecha inicio:</label>
          <input type="date" id="fecha-inicio" class="w-full p-2 border rounded" [(ngModel)]="fechaInicioFiltro">
        </div>

        <!-- Fecha fin -->
        <div class="form-group">
          <label for="fecha-fin">Fecha fin:</label>
          <input type="date" id="fecha-fin" class="w-full p-2 border rounded" [(ngModel)]="fechaFinFiltro">
        </div>

        <!-- Botones centrados respecto al cuadro -->
        <div class="button-group">
          <button type="button" class="btn limpiar" (click)="limpiarFiltros()">
            <i class="material-icons">cached</i> Limpiar
          </button>

          <button type="button" class="btn filtrar" (click)="filtrarSolicitudes()">
            <i class="material-icons">filter_alt</i> Filtrar
          </button>
        </div>
      </div>
    </div>




    <!-- Paginación y tamaño de filas alineados a los bordes -->
    <div class="flex justify-between items-center mt-4 space-x-8">

      <!-- Selector de tamaño de filas alineado a la izquierda -->
      <div class="flex items-center">

        <label for="pageSize" class="mr-2">
          Mostrar:
        </label>

        <select id="pageSize" (change)="cambiarTamanoPagina($event)" class="border border-gray-300 rounded">
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="15">15</option>
        </select>

      </div>

    </div>

    <!-- Tabla con columnas ajustadas y paginación -->
    <table class="min-w-full table-auto border-collapse">
      <thead>
        <!-- Estado “creado” -->
        <tr *ngIf="estadoSeleccionado === 'Creado'" class="bg-[#1C355C] text-white">
          <th *ngIf="columnasVisibles['aprobar']" class="border px-4 py-2 text-center">Aprobar</th>
          <th *ngIf="columnasVisibles['sinEfecto']" class="border px-4 py-2 text-center">Sin efecto</th>
          <th *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">Histórico</th>
          <th *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">Ver</th>
          <th *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">Solicitud</th>
          <th *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">Consecutivo</th>
          <th *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">Número único</th>
          <th *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">Fecha creación</th>
          <th *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">Días transcurridos</th>
          <th *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">Estado</th>
          <th *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">Urgente</th>
          <th *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">Creado por</th>
        </tr>

        <!-- Estado “tramitado” -->
        <tr *ngIf="estadoSeleccionado === 'Tramitado'" class="bg-[#1C355C] text-white">
          <th *ngIf="columnasVisibles['finalizar']" class="border px-4 py-2 text-center">Finalizar</th>
          <th *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">Histórico</th>
          <th *ngIf="columnasVisibles['sinEfecto']" class="border px-4 py-2 text-center">Sin efecto</th>
          <th *ngIf="columnasVisibles['requerimientos']" class="border px-4 py-2 text-center">Requerimientos</th>
          <th *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">Ver</th>
          <th *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">Solicitud</th>
          <th *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">Consecutivo</th>
          <th *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">Número único</th>
          <th *ngIf="columnasVisibles['proveedor']" class="border px-4 py-2 text-center">Proveedor</th>
          <th *ngIf="columnasVisibles['enviadoPor']" class="border px-4 py-2 text-center">Enviado por</th>
          <th *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">Fecha creación</th>
          <th *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">Días transcurridos</th>
          <th *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">Estado</th>
          <th *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">Urgente</th>
          <th *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">Creado por</th>
        </tr>

        <!-- Estado “sin efecto” -->
        <tr *ngIf="estadoSeleccionado === 'Sin Efecto'" class="bg-[#1C355C] text-white">
          <th *ngIf="columnasVisibles['devolver']" class="border px-4 py-2 text-center">Devolver</th>
          <th *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">Histórico</th>
          <th *ngIf="columnasVisibles['requerimientos']" class="border px-4 py-2 text-center">Requerimientos</th>
          <th *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">Ver</th>
          <th *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">Solicitud</th>
          <th *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">Número único</th>
          <th *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">Creado por</th>
          <th *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">Fecha creación</th>
          <th *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">Días transcurridos</th>
          <th *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">Estado</th>
          <th *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">Urgente</th>
        </tr>

        <!-- Estado “pendiente” -->
        <tr *ngIf="estadoSeleccionado === 'Pendiente'" class="bg-[#1C355C] text-white">
          <th *ngIf="columnasVisibles['sinEfecto']" class="border px-4 py-2 text-center">Sin efecto</th>
          <th *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">Histórico</th>
          <th *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">Ver</th>
          <th *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">Solicitud</th>
          <th *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">Consecutivo</th>
          <th *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">Número único</th>
          <th *ngIf="columnasVisibles['aprobacion']" class="border px-4 py-2 text-center">Aprobación</th>
          <th *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">Fecha creación</th>
          <th *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">Días transcurridos</th>
          <th *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">Estado</th>
          <th *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">Urgente</th>
          <th *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">Creado por</th>
        </tr>

        <!-- Estado “finalizado” -->
        <tr *ngIf="estadoSeleccionado === 'Finalizado'" class="bg-[#1C355C] text-white">
          <th *ngIf="columnasVisibles['finalizar']" class="border px-4 py-2 text-center">Finalizar</th>
          <th *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">Histórico</th>
          <th *ngIf="columnasVisibles['legajo']" class="border px-4 py-2 text-center">Legajo</th>
          <th *ngIf="columnasVisibles['requerimientos']" class="border px-4 py-2 text-center">Requerimientos</th>
          <th *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">Ver</th>
          <th *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">Solicitud</th>
          <th *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">Consecutivo</th>
          <th *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">Número único</th>
          <th *ngIf="columnasVisibles['proveedor']" class="border px-4 py-2 text-center">Proveedor</th>
          <th *ngIf="columnasVisibles['enviadoPor']" class="border px-4 py-2 text-center">Enviado por</th>
          <th *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">Fecha creación</th>
          <th *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">Días transcurridos</th>
          <th *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">Estado</th>
          <th *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">Urgente</th>
          <th *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">Creado por</th>
        </tr>

        <!-- Estado “solicitado” -->
        <tr *ngIf="estadoSeleccionado === 'Solicitado'" class="bg-[#1C355C] text-white">
          <th *ngIf="columnasVisibles['aprobar']" class="border px-4 py-2 text-center">Aprobar</th>
          <th *ngIf="columnasVisibles['sinEfecto']" class="border px-4 py-2 text-center">Sin efecto</th>
          <th *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">Histórico</th>
          <th *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">Ver</th>
          <th *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">Solicitud</th>
          <th *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">Consecutivo</th>
          <th *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">Número único</th>
          <th *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">Fecha creación</th>
          <th *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">Días transcurridos</th>
          <th *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">Estado</th>
          <th *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">Urgente</th>
          <th *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">Creado por</th>
        </tr>

        <!-- Estado “legajo” -->
        <tr *ngIf="estadoSeleccionado === 'Legajo'" class="bg-[#1C355C] text-white">
          <th *ngIf="columnasVisibles['devolver']" class="border px-4 py-2 text-center">Devolver</th>
          <th *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">Histórico</th>
          <th *ngIf="columnasVisibles['legajo']" class="border px-4 py-2 text-center">Legajo</th>
          <th *ngIf="columnasVisibles['requerimientos']" class="border px-4 py-2 text-center">Requerimientos</th>
          <th *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">Ver</th>
          <th *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">Solicitud</th>
          <th *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">Consecutivo</th>
          <th *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">Número único</th>
          <th *ngIf="columnasVisibles['proveedor']" class="border px-4 py-2 text-center">Proveedor</th>
          <th *ngIf="columnasVisibles['enviadoPor']" class="border px-4 py-2 text-center">Enviado por</th>
          <th *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">Fecha creación</th>
          <th *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">Días transcurridos</th>
          <th *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">Estado</th>
          <th *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">Urgente</th>
          <th *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">Creado por</th>
        </tr>


      </thead>

      <tbody class="bg-[#F3F4F6] text-black">
        <!-- Fila de datos para el Estado “creado” -->
        <ng-container *ngIf="estadoSeleccionado === 'Creado'">
          <tr *ngFor="let solicitud of solicitudesFiltradas" class="hover:bg-gray-200">
            <td *ngIf="columnasVisibles['aprobar']" class="border px-4 py-2 text-center">
              <!-- Switch para aprobar -->
              <button (click)="aprobarSolicitud(solicitud.idSolicitudProveedor, 'Aprobar')"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                Aprobar
              </button>
            </td>
            <td *ngIf="columnasVisibles['sinEfecto']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalCambioEstado(solicitud.idSolicitudProveedor, 'Sin Efecto')"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">file_copy_off</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">sports_score</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">do_not_disturb_on_total_silence</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">{{
              solicitud.idSolicitudProveedor }}</td>
            <td *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">{{ solicitud.consecutivo }}
            </td>
            <td *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">{{ solicitud.numeroUnico }}
            </td>
            <td *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">{{
              solicitud.fechaCreacion | date: 'dd/MM/yyyy' }}</td>
            <td *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">{{
              calcularDiasTranscurridos(solicitud.fechaCreacion) }}</td>
            <td *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">{{ solicitud.estado?.nombre }}
            </td>
            <td *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">{{ solicitud.urgente ? 'Sí' :
              'No' }}</td>
            <td *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">{{
              solicitud.usuarioCreador?.nombre }} {{ solicitud.usuarioCreador?.apellido || '' }}</td>
          </tr>
        </ng-container>

        <!-- Fila de datos para el Estado "Solicitado" -->
        <ng-container *ngIf="estadoSeleccionado === 'Solicitado'">
          <tr *ngFor="let solicitud of solicitudesFiltradas" class="hover:bg-gray-200">
            <td *ngIf="columnasVisibles['aprobar']" class="border px-4 py-2 text-center">
              <!-- Switch para aprobar -->
              <label class="switch">
                <input type="checkbox" [(ngModel)]="solicitud.aprobado">
                <span class="slider round"></span>
              </label>
            </td>
            <td *ngIf="columnasVisibles['sinEfecto']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalCambioEstado(solicitud.idSolicitudProveedor, 'Sin Efecto')"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">file_copy_off</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">sports_score</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">do_not_disturb_on_total_silence</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">{{
              solicitud.idSolicitudProveedor }}</td>
            <td *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">{{ solicitud.consecutivo }}
            </td>
            <td *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">{{ solicitud.numeroUnico }}
            </td>
            <td *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">{{
              solicitud.fechaCreacion | date: 'dd/MM/yyyy' }}</td>
            <td *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">{{
              calcularDiasTranscurridos(solicitud.fechaCreacion) }}</td>
            <td *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">{{ solicitud.estado?.nombre }}
            </td>
            <td *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">{{ solicitud.urgente ? 'Sí' :
              'No' }}</td>
            <td *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">{{
              solicitud.usuarioCreador?.nombre }} {{ solicitud.usuarioCreador?.apellido || '' }}</td>
          </tr>
        </ng-container>

        <!-- Fila de datos para el Estado “legajo” -->
        <ng-container *ngIf="estadoSeleccionado === 'Legajo'">
          <tr *ngFor="let solicitud of solicitudesFiltradas" class="hover:bg-gray-200">
            <td *ngIf="columnasVisibles['devolver']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalCambioEstado(solicitud.idSolicitudProveedor, 'Devolver')"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">redo</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">sports_score</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['legajo']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalCambioEstado(solicitud.idSolicitudProveedor, 'Legajo')"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">do_not_disturb_on_total_silence</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['requerimientos']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalRequerimientos(solicitud)"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">description</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">info</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">{{
              solicitud.idSolicitudProveedor }}</td>
            <td *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">{{ solicitud.consecutivo }}
            </td>
            <td *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">{{ solicitud.numeroUnico }}
            </td>
            <td *ngIf="columnasVisibles['proveedor']" class="border px-4 py-2 text-center">{{
              solicitud.operadoras[0].nombre }}</td>
            <td *ngIf="columnasVisibles['enviadoPor']" class="border px-4 py-2 text-center">{{ solicitud.enviadoPor }}
            </td>
            <td *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">{{
              solicitud.fechaCreacion | date: 'dd/MM/yyyy' }}</td>
            <td *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">{{
              calcularDiasTranscurridos(solicitud.fechaCreacion) }}</td>
            <td *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">{{ solicitud.estado?.nombre }}
            </td>
            <td *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">{{ solicitud.urgente ? 'Sí' :
              'No' }}</td>
            <td *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">{{
              solicitud.usuarioCreador?.nombre }} {{ solicitud.usuarioCreador?.apellido || '' }}</td>
          </tr>
        </ng-container>

        <!-- Fila de datos para el Estado “Pendiente” -->

        <ng-container *ngIf="estadoSeleccionado === 'Pendiente'">
          <tr *ngFor="let solicitud of solicitudesFiltradas" class="hover:bg-gray-200">
            <td *ngIf="columnasVisibles['sinEfecto']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalCambioEstado(solicitud.idSolicitudProveedor, 'Sin Efecto')"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">file_copy_off</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">sports_score</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">do_not_disturb_on_total_silence</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">{{
              solicitud.idSolicitudProveedor }}
            </td>
            <td *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">{{ solicitud.consecutivo }}
            </td>
            <td *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">{{ solicitud.numeroUnico }}
            </td>
            <td *ngIf="columnasVisibles['aprobacion']" class="border px-4 py-2 text-center">{{ solicitud.aprobacion }}
            </td>
            <td *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">{{
              solicitud.fechaCreacion | date: 'dd/MM/yyyy' }}</td>
            <td *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">{{
              calcularDiasTranscurridos(solicitud.fechaCreacion) }}</td>
            <td *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">{{ solicitud.estado?.nombre }}
            </td>
            <td *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">{{ solicitud.urgente ? 'Sí' :
              'No' }}</td>
            <td *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">{{
              solicitud.usuarioCreador?.nombre }} {{ solicitud.usuarioCreador?.apellido || '' }}</td>
          </tr>
        </ng-container>


        <!-- Fila de datos para el Estado “Sin Efecto” -->

        <ng-container *ngIf="estadoSeleccionado === 'Sin Efecto'">
          <tr *ngFor="let solicitud of solicitudesFiltradas" class="hover:bg-gray-200">
            <td *ngIf="columnasVisibles['devolver']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalCambioEstado(solicitud.idSolicitudProveedor, 'Devolver')"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">redo</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">sports_score</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['requerimientos']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">description</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">info</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">{{
              solicitud.idSolicitudProveedor }}</td>
            <td *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">{{ solicitud.numeroUnico }}
            </td>
            <td *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">{{
              solicitud.usuarioCreador?.nombre }} {{ solicitud.usuarioCreador?.apellido || '' }}</td>
            <td *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">{{
              solicitud.fechaCreacion | date: 'dd/MM/yyyy' }}</td>
            <td *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">{{
              calcularDiasTranscurridos(solicitud.fechaCreacion) }}</td>
            <td *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">{{ solicitud.estado?.nombre }}
            </td>
            <td *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">{{ solicitud.urgente ? 'Sí' :
              'No' }}</td>
          </tr>
        </ng-container>

        <!-- Fila de datos para el Estado “Tramitado -->

        <ng-container *ngIf="estadoSeleccionado === 'Tramitado'">
          <tr *ngFor="let solicitud of solicitudesFiltradas" class="hover:bg-gray-200">
            <td *ngIf="columnasVisibles['finalizar']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalCambioEstado(solicitud.idSolicitudProveedor, 'Finalizar')"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">start</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">sports_score</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['sinEfecto']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalCambioEstado(solicitud.idSolicitudProveedor, 'Sin Efecto')"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">file_copy_off</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['requerimientos']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalRequerimientos(solicitud)"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">description</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">info</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">{{
              solicitud.idSolicitudProveedor }}</td>
            <td *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">{{ solicitud.consecutivo }}
            </td>
            <td *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">{{ solicitud.numeroUnico }}
            </td>
            <td *ngIf="columnasVisibles['proveedor']" class="border px-4 py-2 text-center">{{
              solicitud.operadoras[0].nombre }}</td>
            <td *ngIf="columnasVisibles['enviadoPor']" class="border px-4 py-2 text-center">{{ solicitud.enviadoPor }}
            </td>
            <td *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">{{
              solicitud.fechaCreacion | date: 'dd/MM/yyyy' }}</td>
            <td *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">{{
              calcularDiasTranscurridos(solicitud.fechaCreacion) }}</td>
            <td *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">{{ solicitud.estado?.nombre }}
            </td>
            <td *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">{{ solicitud.urgente ? 'Sí' :
              'No' }}</td>
            <td *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">{{
              solicitud.usuarioCreador?.nombre }} {{ solicitud.usuarioCreador?.apellido || '' }}</td>
          </tr>
        </ng-container>

        <!-- Fila de datos para el Estado "Finalizado" -->

        <ng-container *ngIf="estadoSeleccionado === 'Finalizado'">
          <tr *ngFor="let solicitud of solicitudesFiltradas" class="hover:bg-gray-200">
            <td *ngIf="columnasVisibles['finalizar']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalCambioEstado(solicitud.idSolicitudProveedor, 'Finalizar')"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">redo</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['historico']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">sports_score</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['legajo']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalCambioEstado(solicitud.idSolicitudProveedor, 'Legajo')"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">do_not_disturb_on_total_silence</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['requerimientos']" class="border px-4 py-2 text-center">
              <button (click)="abrirModalRequerimientos(solicitud)"
                class="text-white px-4 py-2 rounded focus:outline-none focus:ring" style="background-color: #1C355C;">
                <i class="material-icons">description</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['ver']" class="border px-4 py-2 text-center">
              <button (click)="abrirModal(solicitud)" class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">info</i>
              </button>
            </td>
            <td *ngIf="columnasVisibles['solicitud']" class="border px-4 py-2 text-center">{{
              solicitud.idSolicitudProveedor }}
            </td>
            <td *ngIf="columnasVisibles['consecutivo']" class="border px-4 py-2 text-center">{{ solicitud.consecutivo }}
            </td>
            <td *ngIf="columnasVisibles['numeroUnico']" class="border px-4 py-2 text-center">{{ solicitud.numeroUnico }}
            </td>
            <td *ngIf="columnasVisibles['proveedor']" class="border px-4 py-2 text-center">{{
              solicitud.operadoras[0].nombre }}
            </td>
            <td *ngIf="columnasVisibles['enviadoPor']" class="border px-4 py-2 text-center">{{ solicitud.enviadoPor }}
            </td>
            <td *ngIf="columnasVisibles['fechaCreacion']" class="border px-4 py-2 text-center">{{
              solicitud.fechaCreacion | date: 'dd/MM/yyyy' }}</td>
            <td *ngIf="columnasVisibles['diasTranscurridos']" class="border px-4 py-2 text-center">{{
              calcularDiasTranscurridos(solicitud.fechaCreacion) }}</td>
            <td *ngIf="columnasVisibles['estado']" class="border px-4 py-2 text-center">{{ solicitud.estado?.nombre }}
            </td>
            <td *ngIf="columnasVisibles['urgente']" class="border px-4 py-2 text-center">{{ solicitud.urgente ? 'Sí' :
              'No' }}</td>
            <td *ngIf="columnasVisibles['creadoPor']" class="border px-4 py-2 text-center">{{
              solicitud.usuarioCreador?.nombre }} {{ solicitud.usuarioCreador?.apellido || '' }}</td>
          </tr>
        </ng-container>

      </tbody>

    </table>




  </div>

  <!-- Paginación y tamaño de filas centrados -->
  <div class="flex justify-between items-center mt-4 space-x-8">

    <!-- Selector de tamaño de filas -->
    <div class="flex items-center">

      <label for="pageSize" class="mr-2">Mostrar registros del {{((this.pageNumber - 1) * this.pageSize) + 1}}
        al {{((this.pageNumber - 1) * this.pageSize) + this.pageSize}}
        de un total de {{solicitudesFiltradas.length}} registros
        (Filtrado de un total de {{solicitudes.length}})</label>

    </div>

    <!-- Paginación -->
    <div class="flex items-center space-x-2">

      <!-- Botón regresar -->
      <button class="p-2 rounded bg-gray-200 hover:bg-gray-300" (click)="cambiarPagina(-1)">

        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>

      </button>

      <span>{{ pageNumber }}</span> <!-- Número de página -->

      <!-- Botón siguiente -->
      <button class="p-2 rounded bg-gray-200 hover:bg-gray-300" (click)="cambiarPagina(1)">

        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>

      </button>

    </div>

  </div>



</div>

<div>

  <!-- Modal de solicitud -->
  <div *ngIf="modalVisible" class="fixed z-10 inset-0 overflow-y-auto" aria-labelledby="modal-title" role="dialog"
    aria-modal="true">

    <div class="flex items-center justify-center min-h-screen text-center sm:block sm:p-0">

      <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>

      <!-- Contenedor que centra el modal -->
      <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>

      <!-- Contenido del modal centrado y desplazable -->

      <div
        class="inline-block align-middle bg-white rounded-lg overflow-hidden shadow-xl transform transition-all sm:max-w-4xl sm:w-full">

        <!-- Encabezado del modal -->
        <div class="modal-header">
          <h3 class="text-lg font-medium">Solicitud #{{ solicitudSeleccionada.idSolicitudProveedor }}</h3>
          <h3 class="text-lg font-medium">Solicitud archivos telefónicos a proveedor</h3>
        </div>

        <!-- Contenido del formulario -->
        <div class="modal-body">

          <!-- Información General -->
          <div class="grid-section">

            <div>
              <label class="label" for="numeroUnico">Número único:</label>
              <input type="text" id="numeroUnico" class="input" [value]="solicitudSeleccionada.numeroUnico" readonly>
            </div>

            <div>
              <label class="label" for="numeroCaso">Número caso:</label>
              <input type="text" id="numeroCaso" class="input" [value]="solicitudSeleccionada.numeroCaso" readonly>
            </div>

            <div>
              <label class="label" for="fiscalia">Fiscalía:</label>
              <input type="text" id="fiscalia" class="input" [value]="solicitudSeleccionada.fiscalia.nombre" readonly>
            </div>

          </div>

          <!-- Información sobre Delito y Modalidad -->
          <div class="grid-section">

            <div>
              <label class="label" for="categoriaDelito">Categoría delito:</label>
              <input type="text" id="categoriaDelito" class="input"
                [value]="solicitudSeleccionada.categoriaDelito.nombre" readonly>
            </div>

            <div>
              <label class="label" for="modalidad">Modalidad:</label>
              <input type="text" id="modalidad" class="input" [value]="solicitudSeleccionada.modalidad.nombre" readonly>
            </div>

            <div>
              <label class="label" for="imputado">Imputado:</label>
              <input type="text" id="imputado" class="input" [value]="solicitudSeleccionada.imputado" readonly>
            </div>

          </div>

          <!-- Información sobre Delito y Sub Modalidad -->
          <div class="grid-section">

            <div>
              <label class="label" for="delito">Delito:</label>
              <input type="text" id="delito" class="input" [value]="solicitudSeleccionada.delito.nombre" readonly>
            </div>

            <div>
              <label class="label" for="subModalidad">Sub modalidad:</label>
              <input type="text" id="subModalidad" class="input" [value]="solicitudSeleccionada.subModalidad.nombre"
                readonly>
            </div>

            <div>
              <label class="label" for="ofendido">Ofendido:</label>
              <input type="text" id="ofendido" class="input" [value]="solicitudSeleccionada.ofendido" readonly>
            </div>

          </div>

          <!-- Botón de urgente -->
          <div class="grid-section">

            <div>
              <label class="label" for="urgente">Urgente:</label>
              <button type="button" id="urgente" class="text-white py-2 px-4 rounded-md w-full"
                [ngClass]="{'bg-red-600': solicitudSeleccionada.urgente, 'bg-gray-400': !solicitudSeleccionada.urgente}">
                Urgente
              </button>
            </div>

            <div>
              <label class="label" for="oficina">Oficina:</label>
              <input type="text" id="oficina" class="input" readonly>
            </div>

            <div>
              <label class="label" for="operadora">Operadora:</label>
              <input type="text" id="operadora" class="input" [value]="solicitudSeleccionada.operadoras[0].nombre"
                readonly>
            </div>

          </div>

          <!-- Sección de "Registros de requerimientos" -->
          <div class="mt-6">

            <h4 class="text-lg font-medium">Registros de requerimientos</h4>

            <div class="border-t mt-2"></div>

            <table class="table">

              <thead>
                <tr>
                  <th>Requerimiento</th>
                  <th>Tipo Solicitud</th>
                  <th>Datos Requeridos</th>
                  <th>Fecha Inicio</th>
                  <th>Fecha Final</th>
                </tr>
              </thead>

              <tbody>

                <tr *ngFor="let requerimiento of solicitudSeleccionada.requerimientos">

                  <td>{{ requerimiento.tC_Requerimiento }}</td>

                  <td>
                    <ul>
                      <li *ngFor="let tipo of requerimiento.tipoSolicitudes">{{ tipo.nombre }},</li>
                    </ul>
                  </td>

                  <td>
                    <ul>
                      <li *ngFor="let dato of requerimiento.datosRequeridos">{{ dato.tC_DatoRequerido }},</li>
                    </ul>
                  </td>

                  <td>{{ requerimiento.tF_FechaInicio | date:'shortDate' }}</td>

                  <td>{{ requerimiento.tF_FechaFinal | date:'shortDate' }}</td>
                </tr>

              </tbody>

            </table>
          </div>
        </div>

        <!-- Botón de cerrar -->
        <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
          <button type="button" class="bg-[#D32F2F] text-white py-2 px-4 rounded-md items-center space-x-2"
            (click)="cerrarModal()">
            <i class="material-icons">cancel</i>
            <span>Cerrar</span>
          </button>
        </div>

      </div>

    </div>

  </div>

</div>


<!-- Modal de confirmación -->
<div *ngIf="modalEstadoVisible" class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-96">
    <h2 class="text-xl font-semibold mb-4">Confirmar Cambio de Estado</h2>
    <p>¿Estás seguro de que deseas cambiar el estado de esta solicitud a "{{ nuevoEstado }}"?</p>

    <!-- Campo de observación opcional -->
    <div class="mt-4">
      <label for="observacion" class="block text-sm font-medium text-gray-700">Observación (opcional)</label>
      <textarea id="observacion" rows="3" [(ngModel)]="observacion"
        class="w-full p-2 border rounded-md focus:outline-none focus:ring"></textarea>
    </div>

    <!-- Botones de confirmación y cancelación -->
    <div class="mt-6 flex justify-end space-x-3">
      <button (click)="confirmarCambioEstado()" style="background-color: #1C355C;"
        class="px-4 py-2 text-white rounded-md focus:outline-none">Confirmar</button>
      <button (click)="cerrarModalCambioEstado()"
        class="px-4 py-2 bg-gray-400 text-white rounded-md focus:outline-none">Cancelar</button>
    </div>
  </div>
</div>


<!-- Modal para mostrar los requerimientos de la solicitud -->
<div *ngIf="modalRequerimientosVisible"
  class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-[80%] max-w-4xl">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-semibold">Requerimientos de Solicitud #{{ solicitudSeleccionada.numeroUnico }}</h2>
      <button (click)="cerrarModalRequerimientos()" aria-label="Close" class="text-gray-500 hover:text-gray-700">
        &times;
      </button>
    </div>

    <!-- Tabla de requerimientos -->
    <div class="overflow-x-auto">
      <table class="min-w-full border border-gray-200">
        <thead class="bg-[#1C355C] text-white">
          <tr>
            <th class="px-4 py-2 text-center">Archivos</th>
            <th class="px-4 py-2 text-left">Requerimiento</th>
            <th class="px-4 py-2 text-left">Núm. requerido</th>
            <th class="px-4 py-2 text-left">Rango de fechas</th>
            <th class="px-4 py-2 text-left">Observación</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let requerimiento of solicitudSeleccionada?.requerimientos" class="border-b border-gray-200">
            <td class="px-4 py-2 text-center">
              <button class="text-white px-4 py-2 rounded focus:outline-none focus:ring"
                style="background-color: #1C355C;">
                <i class="material-icons">folder</i>
              </button>
            </td>
            <td class="px-4 py-2">{{ requerimiento.requerimiento }}</td>
            <td class="px-4 py-2">
              <!-- Iteración sobre datosRequeridos para mostrar datoRequeridoContenido -->
              <ul>
                <li *ngFor="let dato of requerimiento.datosRequeridos">
                  {{ dato.datoRequeridoContenido }}
                </li>
              </ul>
            </td>
            <td class="px-4 py-2">{{ requerimiento.fechaInicio }} al {{ requerimiento.fechaFinal }}</td>
            <td class="px-4 py-2">{{ requerimiento.observacion }}</td>
          </tr>

        </tbody>
      </table>
    </div>

    <!-- Botón de cerrar -->
    <div class="mt-6 flex justify-end">
      <button (click)="cerrarModalRequerimientos()" class="px-4 py-2 text-white rounded-md"
        style="background-color: #1C355C;">
        Cerrar
      </button>
    </div>
  </div>
</div>